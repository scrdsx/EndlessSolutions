local License = "KEYAUTH-D12fac-I0l6j0-pTI31p-3m2bsj-ZHoUdA-aWx0LQ" --* Your License to use this script.

local HttpService = game:GetService("HttpService")
local StarterGui = game:GetService("StarterGui")
local LuaName = "KeyAuth"

StarterGui:SetCore("SendNotification", {
	Title = LuaName,
	Text = "Intializing Authentication...",
	Duration = 5
})

--* Configuration *--
local initialized = false
local sessionid = ""

--* Application Details *--
Name = "hyperion" --* Application Name
Ownerid = "pIZcfcgqTd" --* OwnerID
APPVersion = "1.0"     --* Application Version

local req = game:HttpGet('https://keyauth.win/api/1.1/?name=' .. Name .. '&ownerid=' .. Ownerid .. '&type=init&ver=' .. APPVersion)

if req == "KeyAuth_Invalid" then 
    print(" Error: Application not found.")

    StarterGui:SetCore("SendNotification", {
        Title = LuaName,
        Text = " Error: Application not found.",
        Duration = 3
    })

    return false
end

local data = HttpService:JSONDecode(req)

if data.success == true then
    initialized = true
    sessionid = data.sessionid
elseif (data.message == "invalidver") then
    print(" Error: Wrong application version..")

    StarterGui:SetCore("SendNotification", {
        Title = LuaName,
        Text = " Error: Wrong application version..",
        Duration = 3
    })

    return false
else
    print(" Error: " .. data.message)
    return false
end

print("\n\n Licensing... \n")
local req = game:HttpGet('https://keyauth.win/api/1.1/?name=' .. Name .. '&ownerid=' .. Ownerid .. '&type=license&key=' .. License ..'&ver=' .. APPVersion .. '&sessionid=' .. sessionid)
local data = HttpService:JSONDecode(req)

if data.success == false then 
    StarterGui:SetCore("SendNotification", {
        Title = LuaName,
        Text = " Error: " .. data.message,
        Duration = 5
    })

    return false
end

StarterGui:SetCore("SendNotification", {
    Title = LuaName,
    Text = " Successfully Authorized :)",
    Duration = 5
})

--* Your code here *--

local player = game.Players.LocalPlayer
local UserInputService = game:GetService("UserInputService")

local isRunning = false
local isUIVisible = true

-- Create the UI elements
local screenGui = Instance.new("ScreenGui", player:WaitForChild("PlayerGui"))
screenGui.Name = "TeleportGui"
screenGui.ResetOnSpawn = false

local frame = Instance.new("Frame", screenGui)
frame.Size = UDim2.new(0, 600, 0, 400)
frame.Position = UDim2.new(0.5, -300, 0.5, -200)
frame.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
frame.BorderSizePixel = 0
frame.Active = true
frame.Draggable = true

-- Title text
local title = Instance.new("TextLabel", frame)
title.Size = UDim2.new(1, 0, 0, 30)
title.Position = UDim2.new(0, 0, 0, 0)
title.BackgroundTransparency = 1
title.Text = "KeyAuth - Beta"
title.TextColor3 = Color3.new(1, 1, 1)
title.TextScaled = true

-- Minimize button
local minimizeButton = Instance.new("TextButton", frame)
minimizeButton.Size = UDim2.new(0, 30, 0, 30)
minimizeButton.Position = UDim2.new(1, -30, 0, 0)
minimizeButton.BackgroundColor3 = Color3.new(1, 0, 1)
minimizeButton.Text = "-"
minimizeButton.TextColor3 = Color3.new(1, 1, 1)
minimizeButton.TextScaled = true

-- Tabs
local tabs = {"ESP", "Aiming", "Misc", "Configs"}
local tabButtons = {}
local activeTab = "ESP"

local tabFrame = Instance.new("Frame", frame)
tabFrame.Size = UDim2.new(1, 0, 0, 30)
tabFrame.Position = UDim2.new(0, 0, 0, 30)
tabFrame.BackgroundTransparency = 1

for i, tabName in ipairs(tabs) do
    local tabButton = Instance.new("TextButton", tabFrame)
    tabButton.Size = UDim2.new(0, 100, 1, 0)
    tabButton.Position = UDim2.new(0, (i-1) * 100, 0, 0)
    tabButton.BackgroundColor3 = Color3.new(0, 0, 0)
    tabButton.BorderColor3 = Color3.new(0.5, 0.5, 0.5)
    tabButton.Text = tabName
    tabButton.TextColor3 = Color3.new(1, 1, 1)
    tabButton.TextScaled = true
    tabButtons[tabName] = tabButton
end

-- Tab contents
local contentFrames = {}

for _, tabName in ipairs(tabs) do
    local contentFrame = Instance.new("Frame", frame)
    contentFrame.Size = UDim2.new(1, 0, 1, -60)
    contentFrame.Position = UDim2.new(0, 0, 0, 60)
    contentFrame.BackgroundColor3 = Color3.fromRGB(35, 35, 35)
    contentFrame.Visible = (tabName == activeTab)
    contentFrames[tabName] = contentFrame
end

-- ESP Tab content
local espFrame = contentFrames["ESP"]

-- Enemy Flags Section
local enemyFlagsLabel = Instance.new("TextLabel", espFrame)
enemyFlagsLabel.Size = UDim2.new(0, 200, 0, 30)
enemyFlagsLabel.Position = UDim2.new(0, 10, 0, 10)
enemyFlagsLabel.BackgroundTransparency = 1
enemyFlagsLabel.Text = "Enemy Flags"
enemyFlagsLabel.TextColor3 = Color3.new(1, 1, 1)
enemyFlagsLabel.TextScaled = true
enemyFlagsLabel.TextXAlignment = Enum.TextXAlignment.Left

local function createCheckbox(parent, label, posX, posY)
    local checkbox = Instance.new("TextButton", parent)
    checkbox.Size = UDim2.new(0, 20, 0, 20)
    checkbox.Position = UDim2.new(0, posX, 0, posY)
    checkbox.BackgroundColor3 = Color3.new(0, 0, 0)
    checkbox.BorderColor3 = Color3.new(1, 0, 1)
    checkbox.BorderSizePixel = 2
    checkbox.Text = ""
    
    local checkMark = Instance.new("TextLabel", checkbox)
    checkMark.Size = UDim2.new(1, 0, 1, 0)
    checkMark.BackgroundTransparency = 1
    checkMark.Text = ""
    checkMark.TextColor3 = Color3.new(1, 1, 1)
    checkMark.TextScaled = true
    
    local label = Instance.new("TextLabel", parent)
    label.Size = UDim2.new(0, 150, 0, 20)
    label.Position = UDim2.new(0, posX + 30, 0, posY)
    label.BackgroundTransparency = 1
    label.Text = label
    label.TextColor3 = Color3.new(1, 1, 1)
    label.TextScaled = true
    label.TextXAlignment = Enum.TextXAlignment.Left
    
    return checkbox, checkMark
end

local silentAimCheckbox, silentAimCheckMark = createCheckbox(espFrame, "Silent Aim", 10, 50)

local function updateCheckBox(checkbox, checkMark, state)
    if state then
        checkMark.Text = "âœ“"
    else
        checkMark.Text = ""
    end
end

silentAimCheckbox.MouseButton1Click:Connect(function()
    isRunning = not isRunning
    updateCheckBox(silentAimCheckbox, silentAimCheckMark, isRunning)
end)

minimizeButton.MouseButton1Click:Connect(function()
    isUIVisible = not isUIVisible
    frame.Visible = isUIVisible
end)

UserInputService.InputBegan:Connect(function(input, gameProcessed)
    if gameProcessed then return end
    if input.KeyCode == Enum.KeyCode.RightShift then
        isUIVisible = not isUIVisible
        frame.Visible = isUIVisible
    end
end)

for tabName, tabButton in pairs(tabButtons) do
    tabButton.MouseButton1Click:Connect(function()
        activeTab = tabName
        for tName, contentFrame in pairs(contentFrames) do
            contentFrame.Visible = (tName == activeTab)
        end
    end)
end

local function performEKeyAction()
    print("performEKeyAction called")
    -- SomeFunctionTriggeredByE() -- Ensure this function is defined or implement its functionality here.
end

local function teleportToJobRig()
    print("teleportToJobRig called")
    local jobRigModel = game.Workspace:FindFirstChild("JobRig")
    
    if jobRigModel and jobRigModel:IsA("Model") then
        local targetPart = jobRigModel.PrimaryPart or jobRigModel:FindFirstChild("HumanoidRootPart") or jobRigModel:FindFirstChildWhichIsA("BasePart")
        
        if targetPart then
            local character = player.Character
            
            if character then
                local humanoidRootPart = character:FindFirstChild("HumanoidRootPart")
                
                if humanoidRootPart then
                    humanoidRootPart.CFrame = targetPart.CFrame
                    
                    wait(4)
                    
                    local deliveryPositions = {}
                    
                    for _, part in pairs(game.Workspace:GetDescendants()) do
                        if part:IsA("BasePart") and part.Name == "DeliveryPosition" then
                            table.insert(deliveryPositions, part)
                        end
                    end
                    
                    for _, pos in ipairs(deliveryPositions) do
                        humanoidRootPart.CFrame = pos.CFrame
                        wait(0.5)
                    end
                    
                    local startTime = tick()
                    local duration = 4
                    
                    while tick() - startTime < duration do
                        performEKeyAction()
                        wait(0.5)
                    end
                else
                    warn("HumanoidRootPart not found in character.")
                end
            else
                warn("Character not found for player.")
            end
        else
            warn("No suitable part found in JobRig model to teleport to.")
        end
    else
        warn("JobRig model not found in workspace.")
    end
end

local function runTeleportLoop()
    while true do
        if isRunning then
            teleportToJobRig()
        end
        wait(2)
    end
end

spawn(runTeleportLoop)
